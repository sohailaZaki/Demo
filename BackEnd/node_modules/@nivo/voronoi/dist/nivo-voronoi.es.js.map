{"version":3,"file":"nivo-voronoi.es.js","sources":["../src/props.ts","../src/computeMesh.ts","../src/hooks.ts","../src/Voronoi.tsx","../src/ResponsiveVoronoi.tsx","../src/Mesh.tsx","../src/meshCanvas.ts"],"sourcesContent":["import { VoronoiDomain, VoronoiLayer } from './types'\n\nexport const defaultVoronoiProps = {\n    xDomain: [0, 1] as VoronoiDomain,\n    yDomain: [0, 1] as VoronoiDomain,\n    layers: ['links', 'cells', 'points', 'bounds'] as VoronoiLayer[],\n    enableLinks: false,\n    linkLineWidth: 1,\n    linkLineColor: '#bbbbbb',\n    enableCells: true,\n    cellLineWidth: 2,\n    cellLineColor: '#000000',\n    enablePoints: true,\n    pointSize: 4,\n    pointColor: '#666666',\n    role: 'img',\n}\n","import { Delaunay } from 'd3-delaunay'\n\ntype NumberPropertyNames<T> = {\n    [K in keyof T]: T[K] extends number ? K : never\n}[keyof T]\n\nexport type XYAccessor<Datum> = NumberPropertyNames<Datum> | ((datum: Datum) => number)\n\nconst getAccessor = <Datum>(directive: XYAccessor<Datum>) =>\n    typeof directive === 'function' ? directive : (datum: Datum) => datum[directive]\n\n/**\n * The delaunay generator requires an array\n * where each point is defined as an array\n * of 2 elements: [x: number, y: number].\n *\n * Points represent the raw input data\n * and x/y represent accessors to x & y.\n */\nexport const computeMeshPoints = <Datum>({\n    points,\n    x = 'x' as NumberPropertyNames<Datum>,\n    y = 'y' as NumberPropertyNames<Datum>,\n}: {\n    points: Datum[]\n    x?: XYAccessor<Datum>\n    y?: XYAccessor<Datum>\n}): [number, number][] => {\n    const getX = getAccessor<Datum>(x)\n    const getY = getAccessor<Datum>(y)\n\n    return points.map(point => [getX(point) as number, getY(point) as number])\n}\n\nexport const computeMesh = ({\n    points,\n    width,\n    height,\n    debug,\n}: {\n    points: [number, number][]\n    width: number\n    height: number\n    debug?: boolean\n}) => {\n    const delaunay = Delaunay.from(points)\n    const voronoi = debug ? delaunay.voronoi([0, 0, width, height]) : undefined\n\n    return { delaunay, voronoi }\n}\n","import { useMemo } from 'react'\nimport { scaleLinear } from 'd3-scale'\nimport { Delaunay } from 'd3-delaunay'\nimport { computeMeshPoints, computeMesh, XYAccessor } from './computeMesh'\nimport { VoronoiCommonProps, VoronoiDatum, VoronoiCustomLayerProps } from './types'\n\nexport const useVoronoiMesh = <Datum>({\n    points,\n    x,\n    y,\n    width,\n    height,\n    debug,\n}: {\n    points: Datum[]\n    x?: XYAccessor<Datum>\n    y?: XYAccessor<Datum>\n    width: number\n    height: number\n    debug?: boolean\n}) => {\n    const points2d = useMemo(() => computeMeshPoints<Datum>({ points, x, y }), [points, x, y])\n\n    return useMemo(\n        () => computeMesh({ points: points2d, width, height, debug }),\n        [points2d, width, height, debug]\n    )\n}\n\nexport const useVoronoi = ({\n    data,\n    width,\n    height,\n    xDomain,\n    yDomain,\n}: {\n    data: VoronoiDatum[]\n    width: number\n    height: number\n    xDomain: VoronoiCommonProps['xDomain']\n    yDomain: VoronoiCommonProps['yDomain']\n}) => {\n    const xScale = useMemo(() => scaleLinear().domain(xDomain).range([0, width]), [xDomain, width])\n    const yScale = useMemo(\n        () => scaleLinear().domain(yDomain).range([0, height]),\n        [yDomain, height]\n    )\n\n    const points = useMemo(\n        () =>\n            data.map(d => ({\n                x: xScale(d.x),\n                y: yScale(d.y),\n                data: d,\n            })),\n        [data, xScale, yScale]\n    )\n\n    return useMemo(() => {\n        const delaunay = Delaunay.from(points.map(p => [p.x, p.y]))\n        const voronoi = delaunay.voronoi([0, 0, width, height])\n\n        return {\n            points,\n            delaunay,\n            voronoi,\n        }\n    }, [points, width, height])\n}\n\n/**\n * Memoize the context to pass to custom layers.\n */\nexport const useVoronoiLayerContext = ({\n    points,\n    delaunay,\n    voronoi,\n}: VoronoiCustomLayerProps): VoronoiCustomLayerProps =>\n    useMemo(\n        () => ({\n            points,\n            delaunay,\n            voronoi,\n        }),\n        [points, delaunay, voronoi]\n    )\n","import { createElement, Fragment, ReactNode } from 'react'\nimport { Container, SvgWrapper, useDimensions } from '@nivo/core'\nimport { VoronoiSvgProps, VoronoiLayerId } from './types'\nimport { defaultVoronoiProps } from './props'\nimport { useVoronoi, useVoronoiLayerContext } from './hooks'\n\ntype InnerVoronoiProps = Partial<Omit<VoronoiSvgProps, 'data' | 'width' | 'height'>> &\n    Pick<VoronoiSvgProps, 'data' | 'width' | 'height'>\n\nconst InnerVoronoi = ({\n    data,\n    width,\n    height,\n    margin: partialMargin,\n    layers = defaultVoronoiProps.layers,\n    xDomain = defaultVoronoiProps.xDomain,\n    yDomain = defaultVoronoiProps.yDomain,\n    enableLinks = defaultVoronoiProps.enableLinks,\n    linkLineWidth = defaultVoronoiProps.linkLineWidth,\n    linkLineColor = defaultVoronoiProps.linkLineColor,\n    enableCells = defaultVoronoiProps.enableCells,\n    cellLineWidth = defaultVoronoiProps.cellLineWidth,\n    cellLineColor = defaultVoronoiProps.cellLineColor,\n    enablePoints = defaultVoronoiProps.enableCells,\n    pointSize = defaultVoronoiProps.pointSize,\n    pointColor = defaultVoronoiProps.pointColor,\n    role = defaultVoronoiProps.role,\n}: InnerVoronoiProps) => {\n    const { outerWidth, outerHeight, margin, innerWidth, innerHeight } = useDimensions(\n        width,\n        height,\n        partialMargin\n    )\n\n    const { points, delaunay, voronoi } = useVoronoi({\n        data,\n        width: innerWidth,\n        height: innerHeight,\n        xDomain,\n        yDomain,\n    })\n\n    const layerById: Record<VoronoiLayerId, ReactNode> = {\n        links: null,\n        cells: null,\n        points: null,\n        bounds: null,\n    }\n\n    if (enableLinks && layers.includes('links')) {\n        layerById.links = (\n            <path\n                key=\"links\"\n                stroke={linkLineColor}\n                strokeWidth={linkLineWidth}\n                fill=\"none\"\n                d={delaunay.render()}\n            />\n        )\n    }\n\n    if (enableCells && layers.includes('cells')) {\n        layerById.cells = (\n            <path\n                key=\"cells\"\n                d={voronoi.render()}\n                fill=\"none\"\n                stroke={cellLineColor}\n                strokeWidth={cellLineWidth}\n            />\n        )\n    }\n\n    if (enablePoints && layers.includes('points')) {\n        layerById.points = (\n            <path\n                key=\"points\"\n                stroke=\"none\"\n                fill={pointColor}\n                d={delaunay.renderPoints(undefined, pointSize / 2)}\n            />\n        )\n    }\n\n    if (layers.includes('bounds')) {\n        layerById.bounds = (\n            <path\n                key=\"bounds\"\n                fill=\"none\"\n                stroke={cellLineColor}\n                strokeWidth={cellLineWidth}\n                d={voronoi.renderBounds()}\n            />\n        )\n    }\n\n    const layerContext = useVoronoiLayerContext({\n        points,\n        delaunay,\n        voronoi,\n    })\n\n    return (\n        <SvgWrapper width={outerWidth} height={outerHeight} margin={margin} role={role}>\n            {layers.map((layer, i) => {\n                if (layerById[layer as VoronoiLayerId] !== undefined) {\n                    return layerById[layer as VoronoiLayerId]\n                }\n\n                if (typeof layer === 'function') {\n                    return <Fragment key={i}>{createElement(layer, layerContext)}</Fragment>\n                }\n\n                return null\n            })}\n        </SvgWrapper>\n    )\n}\n\nexport const Voronoi = ({\n    theme,\n    ...otherProps\n}: Partial<Omit<VoronoiSvgProps, 'data' | 'width' | 'height'>> &\n    Pick<VoronoiSvgProps, 'data' | 'width' | 'height'>) => (\n    <Container isInteractive={false} animate={false} theme={theme}>\n        <InnerVoronoi {...otherProps} />\n    </Container>\n)\n","import { ResponsiveWrapper } from '@nivo/core'\nimport { VoronoiSvgProps } from './types'\nimport { Voronoi } from './Voronoi'\n\ntype ResponsiveVoronoiProps = Partial<Omit<VoronoiSvgProps, 'data' | 'width' | 'height'>> &\n    Pick<VoronoiSvgProps, 'data'>\n\nexport const ResponsiveVoronoi = (props: ResponsiveVoronoiProps) => (\n    <ResponsiveWrapper>\n        {({ width, height }: { width: number; height: number }) => (\n            <Voronoi width={width} height={height} {...props} />\n        )}\n    </ResponsiveWrapper>\n)\n","import { useRef, useState, useCallback, useMemo, MouseEvent, TouchEvent } from 'react'\nimport { getRelativeCursor } from '@nivo/core'\nimport { useVoronoiMesh } from './hooks'\nimport { XYAccessor } from './computeMesh'\n\ntype MouseHandler<Datum> = (datum: Datum, event: MouseEvent) => void\ntype TouchHandler<Datum> = (datum: Datum, event: TouchEvent) => void\n\ninterface MeshProps<Datum> {\n    nodes: Datum[]\n    width: number\n    height: number\n    x?: XYAccessor<Datum>\n    y?: XYAccessor<Datum>\n    onMouseEnter?: MouseHandler<Datum>\n    onMouseMove?: MouseHandler<Datum>\n    onMouseLeave?: MouseHandler<Datum>\n    onClick?: MouseHandler<Datum>\n    onTouchStart?: TouchHandler<Datum>\n    onTouchMove?: TouchHandler<Datum>\n    onTouchEnd?: TouchHandler<Datum>\n    enableTouchCrosshair?: boolean\n    debug?: boolean\n}\n\nexport const Mesh = <Datum,>({\n    nodes,\n    width,\n    height,\n    x,\n    y,\n    onMouseEnter,\n    onMouseMove,\n    onMouseLeave,\n    onClick,\n    onTouchStart,\n    onTouchMove,\n    onTouchEnd,\n    enableTouchCrosshair = false,\n    debug,\n}: MeshProps<Datum>) => {\n    const elementRef = useRef<SVGGElement>(null)\n    const [currentIndex, setCurrentIndex] = useState<number | null>(null)\n\n    const { delaunay, voronoi } = useVoronoiMesh({\n        points: nodes,\n        x,\n        y,\n        width,\n        height,\n        debug,\n    })\n\n    const voronoiPath = useMemo(() => {\n        if (debug && voronoi) {\n            return voronoi.render()\n        }\n\n        return undefined\n    }, [debug, voronoi])\n\n    const getIndexAndNodeFromMouseEvent = useCallback(\n        (event: MouseEvent<SVGRectElement>) => {\n            if (!elementRef.current) {\n                return [null, null]\n            }\n\n            const [x, y] = getRelativeCursor(elementRef.current, event)\n            const index = delaunay.find(x, y)\n\n            return [index, index !== undefined ? nodes[index] : null] as [number, Datum | null]\n        },\n        [delaunay, nodes]\n    )\n\n    const getIndexAndNodeFromTouchEvent = useCallback(\n        (event: TouchEvent<SVGRectElement>) => {\n            if (!elementRef.current) {\n                return [null, null]\n            }\n\n            const [x, y] = getRelativeCursor(elementRef.current, event)\n            const index = delaunay.find(x, y)\n\n            return [index, index !== undefined ? nodes[index] : null] as [number, Datum | null]\n        },\n        [delaunay, nodes]\n    )\n\n    const handleMouseEnter = useCallback(\n        (event: MouseEvent<SVGRectElement>) => {\n            const [index, node] = getIndexAndNodeFromMouseEvent(event)\n            setCurrentIndex(index)\n            if (node) {\n                onMouseEnter?.(node, event)\n            }\n        },\n        [getIndexAndNodeFromMouseEvent, setCurrentIndex, onMouseEnter]\n    )\n\n    const handleMouseMove = useCallback(\n        (event: MouseEvent<SVGRectElement>) => {\n            const [index, node] = getIndexAndNodeFromMouseEvent(event)\n            setCurrentIndex(index)\n            if (node) {\n                onMouseMove?.(node, event)\n            }\n        },\n        [getIndexAndNodeFromMouseEvent, setCurrentIndex, onMouseMove]\n    )\n\n    const handleMouseLeave = useCallback(\n        (event: MouseEvent<SVGRectElement>) => {\n            setCurrentIndex(null)\n            if (onMouseLeave) {\n                let previousNode: Datum | undefined = undefined\n                if (currentIndex !== null) {\n                    previousNode = nodes[currentIndex]\n                }\n                previousNode && onMouseLeave(previousNode, event)\n            }\n        },\n        [setCurrentIndex, currentIndex, onMouseLeave, nodes]\n    )\n\n    const handleClick = useCallback(\n        (event: MouseEvent<SVGRectElement>) => {\n            const [index, node] = getIndexAndNodeFromMouseEvent(event)\n            setCurrentIndex(index)\n            if (node) {\n                onClick?.(node, event)\n            }\n        },\n        [getIndexAndNodeFromMouseEvent, setCurrentIndex, onClick]\n    )\n\n    const handleTouchStart = useCallback(\n        (event: TouchEvent<SVGRectElement>) => {\n            const [index, node] = getIndexAndNodeFromTouchEvent(event)\n            if (enableTouchCrosshair) {\n                setCurrentIndex(index)\n            }\n            if (node) {\n                onTouchStart?.(node, event)\n            }\n        },\n        [getIndexAndNodeFromTouchEvent, enableTouchCrosshair, onTouchStart]\n    )\n\n    const handleTouchMove = useCallback(\n        (event: TouchEvent<SVGRectElement>) => {\n            const [index, node] = getIndexAndNodeFromTouchEvent(event)\n            if (enableTouchCrosshair) {\n                setCurrentIndex(index)\n            }\n            if (node) {\n                onTouchMove?.(node, event)\n            }\n        },\n        [getIndexAndNodeFromTouchEvent, enableTouchCrosshair, onTouchMove]\n    )\n\n    const handleTouchEnd = useCallback(\n        (event: TouchEvent<SVGRectElement>) => {\n            if (enableTouchCrosshair) {\n                setCurrentIndex(null)\n            }\n            if (onTouchEnd) {\n                let previousNode: Datum | undefined = undefined\n                if (currentIndex !== null) {\n                    previousNode = nodes[currentIndex]\n                }\n                previousNode && onTouchEnd(previousNode, event)\n            }\n        },\n        [enableTouchCrosshair, onTouchEnd, currentIndex, nodes]\n    )\n\n    return (\n        <g ref={elementRef}>\n            {debug && voronoi && (\n                <>\n                    <path d={voronoiPath} stroke=\"red\" strokeWidth={1} opacity={0.75} />\n                    {/* highlight current cell */}\n                    {currentIndex !== null && (\n                        <path fill=\"pink\" opacity={0.35} d={voronoi.renderCell(currentIndex)} />\n                    )}\n                </>\n            )}\n            {/* transparent rect to intercept mouse events */}\n            <rect\n                data-ref=\"mesh-interceptor\"\n                width={width}\n                height={height}\n                fill=\"red\"\n                opacity={0}\n                style={{ cursor: 'auto' }}\n                onMouseEnter={handleMouseEnter}\n                onMouseMove={handleMouseMove}\n                onMouseLeave={handleMouseLeave}\n                onTouchStart={handleTouchStart}\n                onTouchMove={handleTouchMove}\n                onTouchEnd={handleTouchEnd}\n                onClick={handleClick}\n            />\n        </g>\n    )\n}\n","import { Delaunay, Voronoi } from 'd3-delaunay'\n\nexport const renderVoronoiToCanvas = (\n    ctx: CanvasRenderingContext2D,\n    voronoi: Voronoi<Delaunay.Point>\n) => {\n    ctx.save()\n\n    ctx.globalAlpha = 0.75\n    ctx.beginPath()\n    voronoi.render(ctx)\n    ctx.strokeStyle = 'red'\n    ctx.lineWidth = 1\n    ctx.stroke()\n\n    ctx.restore()\n}\n\nexport const renderVoronoiCellToCanvas = (\n    ctx: CanvasRenderingContext2D,\n    voronoi: Voronoi<Delaunay.Point>,\n    index: number\n) => {\n    ctx.save()\n\n    ctx.globalAlpha = 0.35\n    ctx.beginPath()\n    voronoi.renderCell(index, ctx)\n    ctx.fillStyle = 'red'\n    ctx.fill()\n\n    ctx.restore()\n}\n"],"names":["defaultVoronoiProps","xDomain","yDomain","layers","enableLinks","linkLineWidth","linkLineColor","enableCells","cellLineWidth","cellLineColor","enablePoints","pointSize","pointColor","role","getAccessor","directive","datum","computeMeshPoints","_ref","points","_ref$x","x","_ref$y","y","getX","getY","map","point","computeMesh","_ref2","width","height","debug","delaunay","Delaunay","from","voronoi","undefined","useVoronoiMesh","points2d","useMemo","useVoronoi","data","xScale","scaleLinear","domain","range","yScale","d","p","useVoronoiLayerContext","_ref3","InnerVoronoi","partialMargin","margin","_ref$layers","_ref$xDomain","_ref$yDomain","_ref$enableLinks","_ref$linkLineWidth","_ref$linkLineColor","_ref$enableCells","_ref$cellLineWidth","_ref$cellLineColor","_ref$enablePoints","_ref$pointSize","_ref$pointColor","_ref$role","_useDimensions","useDimensions","outerWidth","outerHeight","innerWidth","innerHeight","_useVoronoi","layerById","links","cells","bounds","includes","_jsx","stroke","strokeWidth","fill","render","renderPoints","renderBounds","layerContext","SvgWrapper","children","layer","i","Fragment","createElement","Voronoi","theme","otherProps","_objectWithoutPropertiesLoose","_excluded","Container","isInteractive","animate","_extends","ResponsiveVoronoi","props","ResponsiveWrapper","Mesh","nodes","onMouseEnter","onMouseMove","onMouseLeave","onClick","onTouchStart","onTouchMove","onTouchEnd","_ref$enableTouchCross","enableTouchCrosshair","elementRef","useRef","_useState","useState","currentIndex","setCurrentIndex","_useVoronoiMesh","voronoiPath","getIndexAndNodeFromMouseEvent","useCallback","event","current","_getRelativeCursor","getRelativeCursor","index","find","getIndexAndNodeFromTouchEvent","_getRelativeCursor2","handleMouseEnter","_getIndexAndNodeFromM","node","handleMouseMove","_getIndexAndNodeFromM2","handleMouseLeave","previousNode","handleClick","_getIndexAndNodeFromM3","handleTouchStart","_getIndexAndNodeFromT","handleTouchMove","_getIndexAndNodeFromT2","handleTouchEnd","_jsxs","ref","_Fragment","opacity","renderCell","style","cursor","renderVoronoiToCanvas","ctx","save","globalAlpha","beginPath","strokeStyle","lineWidth","restore","renderVoronoiCellToCanvas","fillStyle"],"mappings":"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"}