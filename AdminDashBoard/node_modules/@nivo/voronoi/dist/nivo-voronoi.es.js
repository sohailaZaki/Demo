import{useMemo as n,Fragment as o,createElement as e,useRef as i,useState as t,useCallback as r}from"react";import{Container as l,useDimensions as u,SvgWrapper as a,ResponsiveWrapper as d,getRelativeCursor as c}from"@nivo/core";import{scaleLinear as s}from"d3-scale";import{Delaunay as h}from"d3-delaunay";import{jsx as f,jsxs as v,Fragment as p}from"react/jsx-runtime";function m(){return m=Object.assign?Object.assign.bind():function(n){for(var o=1;o<arguments.length;o++){var e=arguments[o];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(n[i]=e[i])}return n},m.apply(this,arguments)}var y={xDomain:[0,1],yDomain:[0,1],layers:["links","cells","points","bounds"],enableLinks:!1,linkLineWidth:1,linkLineColor:"#bbbbbb",enableCells:!0,cellLineWidth:2,cellLineColor:"#000000",enablePoints:!0,pointSize:4,pointColor:"#666666",role:"img"},b=function(n){return"function"==typeof n?n:function(o){return o[n]}},g=function(n){var o=n.points,e=n.x,i=void 0===e?"x":e,t=n.y,r=void 0===t?"y":t,l=b(i),u=b(r);return o.map((function(n){return[l(n),u(n)]}))},k=function(n){var o=n.points,e=n.width,i=n.height,t=n.debug,r=h.from(o),l=t?r.voronoi([0,0,e,i]):void 0;return{delaunay:r,voronoi:l}},C=function(o){var e=o.points,i=o.x,t=o.y,r=o.width,l=o.height,u=o.debug,a=n((function(){return g({points:e,x:i,y:t})}),[e,i,t]);return n((function(){return k({points:a,width:r,height:l,debug:u})}),[a,r,l,u])},x=function(o){var e=o.data,i=o.width,t=o.height,r=o.xDomain,l=o.yDomain,u=n((function(){return s().domain(r).range([0,i])}),[r,i]),a=n((function(){return s().domain(l).range([0,t])}),[l,t]),d=n((function(){return e.map((function(n){return{x:u(n.x),y:a(n.y),data:n}}))}),[e,u,a]);return n((function(){var n=h.from(d.map((function(n){return[n.x,n.y]}))),o=n.voronoi([0,0,i,t]);return{points:d,delaunay:n,voronoi:o}}),[d,i,t])},L=function(o){var e=o.points,i=o.delaunay,t=o.voronoi;return n((function(){return{points:e,delaunay:i,voronoi:t}}),[e,i,t])},w=["theme"],W=function(n){var i=n.data,t=n.width,r=n.height,l=n.margin,d=n.layers,c=void 0===d?y.layers:d,s=n.xDomain,h=void 0===s?y.xDomain:s,v=n.yDomain,p=void 0===v?y.yDomain:v,m=n.enableLinks,b=void 0===m?y.enableLinks:m,g=n.linkLineWidth,k=void 0===g?y.linkLineWidth:g,C=n.linkLineColor,w=void 0===C?y.linkLineColor:C,W=n.enableCells,D=void 0===W?y.enableCells:W,M=n.cellLineWidth,S=void 0===M?y.cellLineWidth:M,T=n.cellLineColor,O=void 0===T?y.cellLineColor:T,P=n.enablePoints,j=void 0===P?y.enableCells:P,E=n.pointSize,z=void 0===E?y.pointSize:E,A=n.pointColor,H=void 0===A?y.pointColor:A,B=n.role,F=void 0===B?y.role:B,I=u(t,r,l),q=I.outerWidth,G=I.outerHeight,J=I.margin,K=I.innerWidth,N=I.innerHeight,Q=x({data:i,width:K,height:N,xDomain:h,yDomain:p}),R=Q.points,U=Q.delaunay,V=Q.voronoi,X={links:null,cells:null,points:null,bounds:null};b&&c.includes("links")&&(X.links=f("path",{stroke:w,strokeWidth:k,fill:"none",d:U.render()},"links")),D&&c.includes("cells")&&(X.cells=f("path",{d:V.render(),fill:"none",stroke:O,strokeWidth:S},"cells")),j&&c.includes("points")&&(X.points=f("path",{stroke:"none",fill:H,d:U.renderPoints(void 0,z/2)},"points")),c.includes("bounds")&&(X.bounds=f("path",{fill:"none",stroke:O,strokeWidth:S,d:V.renderBounds()},"bounds"));var Y=L({points:R,delaunay:U,voronoi:V});return f(a,{width:q,height:G,margin:J,role:F,children:c.map((function(n,i){return void 0!==X[n]?X[n]:"function"==typeof n?f(o,{children:e(n,Y)},i):null}))})},D=function(n){var o=n.theme,e=function(n,o){if(null==n)return{};var e,i,t={},r=Object.keys(n);for(i=0;i<r.length;i++)e=r[i],o.indexOf(e)>=0||(t[e]=n[e]);return t}(n,w);return f(l,{isInteractive:!1,animate:!1,theme:o,children:f(W,m({},e))})},M=function(n){return f(d,{children:function(o){var e=o.width,i=o.height;return f(D,m({width:e,height:i},n))}})},S=function(o){var e=o.nodes,l=o.width,u=o.height,a=o.x,d=o.y,s=o.onMouseEnter,h=o.onMouseMove,m=o.onMouseLeave,y=o.onClick,b=o.onTouchStart,g=o.onTouchMove,k=o.onTouchEnd,x=o.enableTouchCrosshair,L=void 0!==x&&x,w=o.debug,W=i(null),D=t(null),M=D[0],S=D[1],T=C({points:e,x:a,y:d,width:l,height:u,debug:w}),O=T.delaunay,P=T.voronoi,j=n((function(){if(w&&P)return P.render()}),[w,P]),E=r((function(n){if(!W.current)return[null,null];var o=c(W.current,n),i=o[0],t=o[1],r=O.find(i,t);return[r,void 0!==r?e[r]:null]}),[O,e]),z=r((function(n){if(!W.current)return[null,null];var o=c(W.current,n),i=o[0],t=o[1],r=O.find(i,t);return[r,void 0!==r?e[r]:null]}),[O,e]),A=r((function(n){var o=E(n),e=o[0],i=o[1];S(e),i&&(null==s||s(i,n))}),[E,S,s]),H=r((function(n){var o=E(n),e=o[0],i=o[1];S(e),i&&(null==h||h(i,n))}),[E,S,h]),B=r((function(n){if(S(null),m){var o=void 0;null!==M&&(o=e[M]),o&&m(o,n)}}),[S,M,m,e]),F=r((function(n){var o=E(n),e=o[0],i=o[1];S(e),i&&(null==y||y(i,n))}),[E,S,y]),I=r((function(n){var o=z(n),e=o[0],i=o[1];L&&S(e),i&&(null==b||b(i,n))}),[z,L,b]),q=r((function(n){var o=z(n),e=o[0],i=o[1];L&&S(e),i&&(null==g||g(i,n))}),[z,L,g]),G=r((function(n){if(L&&S(null),k){var o=void 0;null!==M&&(o=e[M]),o&&k(o,n)}}),[L,k,M,e]);return v("g",{ref:W,children:[w&&P&&v(p,{children:[f("path",{d:j,stroke:"red",strokeWidth:1,opacity:.75}),null!==M&&f("path",{fill:"pink",opacity:.35,d:P.renderCell(M)})]}),f("rect",{"data-ref":"mesh-interceptor",width:l,height:u,fill:"red",opacity:0,style:{cursor:"auto"},onMouseEnter:A,onMouseMove:H,onMouseLeave:B,onTouchStart:I,onTouchMove:q,onTouchEnd:G,onClick:F})]})},T=function(n,o){n.save(),n.globalAlpha=.75,n.beginPath(),o.render(n),n.strokeStyle="red",n.lineWidth=1,n.stroke(),n.restore()},O=function(n,o,e){n.save(),n.globalAlpha=.35,n.beginPath(),o.renderCell(e,n),n.fillStyle="red",n.fill(),n.restore()};export{S as Mesh,M as ResponsiveVoronoi,D as Voronoi,k as computeMesh,g as computeMeshPoints,y as defaultVoronoiProps,O as renderVoronoiCellToCanvas,T as renderVoronoiToCanvas,x as useVoronoi,L as useVoronoiLayerContext,C as useVoronoiMesh};
//# sourceMappingURL=nivo-voronoi.es.js.map
